#include <SoftwareSerial.h>
#include <LiquidCrystal_PCF8574.h>
#include <Wire.h>
const int LedOne = 7;
const int LedTwo = 8;
const int ButOne = 2;
const int ButTwo = 3;
const int ButThree = 4;
const int ButFour = 5;
const int Zoomer = 12;
int ButChangeState =0;
SoftwareSerial RF(10, 11); // RX, TX
int code;
bool vleze = false;
String brak;
int counter =1;
LiquidCrystal_PCF8574 lcd(0x27); // set the LCD address to 0x27 for a 16 chars and 2 line display


void setup() {
  Serial.begin(9600);
  RF.begin(9600);
  pinMode(LedOne,OUTPUT);
  pinMode(LedTwo,OUTPUT);
  pinMode(ButOne, INPUT_PULLUP);
  pinMode(ButTwo, INPUT_PULLUP);
  pinMode(ButThree, INPUT_PULLUP);
  digitalWrite(Zoomer,LOW);
  
  Wire.begin();
  Wire.beginTransmission(0x27);
  lcd.begin(20, 4); // initialize the lcd
  lcd.setBacklight(255);
  lcd.clear();   
  lcd.setCursor(0, 0);
   lcd.print("Scanning...");
}

void loop() {
 while(RF.available()>0){
  code =RF.read();
  // RF.flush();

  Serial.println(code);
  vleze = true;
 }
 if(vleze){
  vleze = false;
while (!Serial.available()){
    //Do Absolutely Nothing until something is received over the serial port
  }
   brak = Serial.readString(); 
   //Serial.flush();
 // Test =Serial.readString();
      
      if(brak!="0"&&brak!="2"){
     WinLCD(brak);
        digitalWrite(Zoomer,HIGH);
        Win();
        digitalWrite(Zoomer,LOW);
        LcdClear();
        
      }
      if(brak=="0"){
        LooseLcd();
        Lose();
        LcdClear();
        
      } 
 }
}

void Win(){
   
  for(int a=0;a<2;a++)
      {
      digitalWrite(LedOne,HIGH);
      delay(200);
      digitalWrite(LedOne,LOW);
      delay(200);
      digitalWrite(LedTwo,HIGH);
      delay(200);
      digitalWrite(LedTwo,LOW);
      delay(200);
      }
}

void Lose(){
  for(int a=0;a<2;a++)
  {
        digitalWrite(LedOne,HIGH);
        digitalWrite(LedTwo,HIGH);
        
        digitalWrite(Zoomer,HIGH);
        delay(1000);
        digitalWrite(Zoomer,LOW);
        
        digitalWrite(LedOne,LOW);
        digitalWrite(LedTwo,LOW);

       
        delay(1000);
        digitalWrite(Zoomer,LOW);
  }
}

void WinLCD(String EmpName){
  lcd.clear();
  lcd.setCursor(0, 0);
   lcd.print("Wait To Pass");
   lcd.setCursor(0, 1);
   lcd.print("Hello");
   lcd.setCursor(0, 2);
   lcd.print(EmpName);
   lcd.setCursor(5, 3);
   lcd.print("Welcome");
   
}
void LooseLcd(){
  lcd.clear();
  lcd.setCursor(0, 0);
   lcd.print("Wait To Pass");
   lcd.setCursor(0, 1);
   lcd.print("Acces Denied");
   lcd.setCursor(0, 2);
   lcd.print(":(:(:(:(:(:(:(:(:(");
}
void LcdClear(){
  delay(2000);
  lcd.clear();
  lcd.clear();
  lcd.setCursor(0, 0);
   lcd.print("Scanning...");
}